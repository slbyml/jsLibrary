{"version":3,"sources":["selectPick---copy.js"],"names":["$","w","document","undefined","resizeWindow","self","setPosition","activeList","ele","addClass","addName","siblings","removeClass","text","data","nowNode","id","hide","node","mask","listHide","off","show","window","container","key","value","listLength","defaults","search","listHeight","opt","_classCallCheck","this","selectPick","placeholder","callback","o","noData","searchLength","change","tabIndex","dom","_createClass","select","getElementById","renderHTML","drop","append","input","find","attr","arguments","length","html","item","m","i","indexOf","searchFlag","lists","items","val","l","scrollTop","eq","currentOffset","offset","top","outerHeight","activeBottom","$active","activeOffset","currentLeft","left","css","currentTop","width","currentWidth","_this","$input","on","e","ev","event","renderList","gotoActive","bind","stopPropagation","cancelBubble","bindKeyDown","outerWidth","$that","_this2","flag","_this3","$next","nextTop","nextOffset","bindItem","nextBottom","keyCode","getValue","back","trim","jQuery"],"mappings":"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","file":"../js/selectPick---copy.min.js","sourcesContent":["/*\r\ncontainer:盛放select得dom\r\nsearch:是否启用模糊搜索\r\ndata:存放数据\r\nkey:有这个说明数组里面是object格式得\r\nlistLength:一屏显示几个list\r\nlistHeight:每个list的高度\r\nplaceholder:提示\r\nvalue:输入框初始值\r\nnoData:没有数据时得显示\r\n*/\r\n;(function($, w, document,undefined){\r\n\t//页面大小改变时时更改下拉框得大小和为止\r\n\tconst resizeWindow=(self)=>{\t\t\t\r\n\t\tself.setPosition()\r\n\t}\t\r\n\t//设置选中项\r\n\tconst activeList=(ele,addName,self)=>{\r\n\t\tele.addClass(addName).siblings().removeClass(addName)\r\n\t\tself.data.nowNode={\t\t\t//记录选中的项的数据\r\n\t\t\tid:ele.data(\"id\"),\r\n\t\t\ttext:ele.text()\r\n\t\t}\r\n\t}\t\r\n\t//隐藏下拉框\r\n\tconst listHide=(self)=>{\t\t\t\r\n\t\tself.data.show=false;\t\t\r\n\t\tself.node.drop.hide();\t\r\n\t\tself.node.mask.hide()\r\n\r\n\t\t//防止混乱和多次绑定事件，每次隐藏下拉时，都注销公用部分事件\r\n\t\tself.node.lists.off(\"click mouseenter\")\t\t\r\n\t\tself.node.mask.off(\"click\")\r\n\r\n\t\t$(window).off(\"resize\",resizeWindow(self))\t\r\n\t\t$(window).off(\"scroll\",self.setPosition())\r\n\t}\r\n\t/*默认值*/\r\n\tconst defaults={\r\n\t\tcontainer:\"body\",\r\n\t\tsearch:false,\r\n\t\tdata:[],\r\n\t\tkey:null,\r\n\t\tvalue:\"\",\r\n\t\tlistLength:4,\r\n\t\tlistHeight:32,\r\n\t\tplaceholder:\"请输入\",\r\n\t\tcallback:null,\r\n\t\tnoData:\"没有数据\"\t\t\r\n\t}\r\n\tclass selectPick{\r\n\t\tconstructor(opt){\r\n\t\t\tthis.o=$.extend(true,{},defaults, opt||{})\r\n\t\t\tthis.dom=$(this.o.container);\r\n\t\t\tthis.data={  //存放插件里面得状态和数据\r\n\t\t\t\tlistLength:0,\t\t//是否有数据\r\n\t\t\t\tsearchLength:0,\t\t//搜索结果的个数\r\n\t\t\t\tshow:false,   //当前下拉是否已经显示\r\n\t\t\t\tchange:false,  //当前数据是否更改过\r\n\t\t\t\ttabIndex:0,  //用来记录按上下键时的id即焦点在第几个li上\r\n\t\t\t\tnowNode:{\t\t//存放已经选中得项\r\n\t\t\t\t\tid:-1,\r\n\t\t\t\t\ttext:\"\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.node={}\t\t//存放插件得dom\t\t\r\n\t\t}\r\n\t\tinit(){\r\n\t\t\tthis.renderHTML()\r\n\t\t\tthis.bind()\r\n\t\t\tif(this.o.search){\t\t//是否有模糊搜索功能\r\n\t\t\t\tthis.search()\r\n\t\t\t}\r\n\t\t}\r\n\t\trenderHTML(){\t\t//渲染页面\r\n\t\t\tthis.node.select=$(` <div class=\"selectPick\" ><input type=\"text\" placeholder=\"${this.o.placeholder}\" value=\"${this.o.value}\"></div>`);\r\n\t\t\t//公共背景\r\n\t\t\tconst mask=document.getElementById(\"selectMask\");\r\n\t\t\tif(!mask){ \r\n\t\t\t\tthis.node.mask=$(\"<div id='selectMask'></div>\")\r\n\t\t\t\t$(\"body\").append(this.node.mask)\r\n\t\t\t}else{\r\n\t\t\t\tthis.node.mask=$(mask)\r\n\t\t\t}\r\n\t\t\t//公共列表\r\n\t\t\tconst drop=document.getElementById(\"selectDrop\");\r\n\t\t\tif(!drop){\t\t\r\n\t\t\t\tthis.node.drop=$(`<div id=\"selectDrop\" style=\"max-height:${this.o.listLength*this.o.listHeight}px\"><ul></ul></div>`)\r\n\t\t\t\t$(\"body\").append(this.node.drop)\r\n\t\t\t}else{\r\n\t\t\t\tthis.node.drop=$(drop)\r\n\t\t\t}\r\n\r\n\t\t\tthis.dom.html(this.node.select);\r\n\t\t\tthis.node.input=this.node.select.find(\"input\");\r\n\t\t\tthis.node.lists=this.node.drop.find(\"ul\");\r\n\t\t\tif(!this.o.search){\t\t//如果没有模糊搜索，则禁用输入框\r\n\t\t\t\tthis.node.input.attr(\"disabled\",\"disabled\")\r\n\t\t\t\tthis.node.select.append(`<div class=\"inputDisabled\"></div>`)\r\n\t\t\t}\t\t\r\n\t\t}\r\n\t\trenderList(text=\"\",searchFlag=false){\t\t//渲染list;text：默认选择和此值匹配得项，searchFlag:区分当前是否是在模糊搜索\r\n\t\t\tlet html=\"\",item=\"\",m=this.data.nowNode.id>=0?this.data.nowNode.id:0;\r\n\t\t\tthis.data.searchLength=0\r\n\t\t\tthis.data.listLength=this.o.data.length\r\n\t\t\tif(this.data.listLength<=0 || this.o.data[0]===\"\") return false;\t\t\t//没有数据\r\n\t\t\tfor(let i=0;i<this.data.listLength;i++){\r\n\t\t\t\titem=this.o.key?this.o.data[i][this.o.key]:this.o.data[i]\r\n\t\t\t\tif(this.o.search && item.indexOf(text)<0 && text != \"\" && searchFlag) continue;\t\t//如果有模糊搜索并且没有匹配到则退出当前循环\r\n\t\t\t\tif(text != \"\" && this.data.nowNode.id<0){\t//如果有初始值,则默认选中初始值\t\r\n\t\t\t\t\tif(item===text){\r\n\t\t\t\t\t\thtml+=`<li data-id=\"${i}\" class=\"active\">${item}</li>`;\r\n\t\t\t\t\t\tthis.data.nowNode={\r\n\t\t\t\t\t\t\tid:i,\r\n\t\t\t\t\t\t\ttext:item\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.data.tabIndex=i\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\thtml+=`<li data-id=\"${i}\">${item}</li>`\r\n\t\t\t\t\t}\t\t\t\t\r\n\t\t\t\t}else{\r\n\t\t\t\t\thtml+=`<li data-id=\"${i}\" ${m===i?`class=\"active\"`:\"\"}>${item}</li>`\r\n\t\t\t\t}\t\t\t\r\n\t\t\t\t++this.data.searchLength\r\n\t\t\t}\r\n\t\t\tif(this.o.search && html===\"\") return false;  //搜索时没有匹配到\r\n\t\t\tthis.node.lists.html(html)\r\n\t\t\tthis.node.items=this.node.lists.find(\"li\");\t\t//选择已经渲染到页面得数据node\r\n\t\t\treturn true\r\n\t\t}\r\n\t\tsetData(data=[]){\t\t\t//设置下拉列表得数据\r\n\t\t\tthis.o.data=data;\r\n\t\t\tif(this.o.value === \"\"){\r\n\t\t\t\tthis.node.input.val(\"\");\t\t\t\r\n\t\t\t}else{\r\n\t\t\t\tthis.node.input.val(this.o.value)\r\n\t\t\t}\r\n\t\t\tthis.data={\r\n\t\t\t\tshow:false,\r\n\t\t\t\tnowNode:{\r\n\t\t\t\t\tid:-1,\r\n\t\t\t\t\ttext:\"\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.data.show=false;\r\n\t\t\tthis.node.drop.hide();\t\r\n\t\t\tthis.node.mask.hide()\r\n\t\t\treturn this\r\n\t\t}\r\n\t\tgetValue(){\t\t\t//获取已经选中得项得数据\r\n\t\t\treturn {\r\n\t\t\t\tdata:this.data.nowNode.id<0?-1:this.o.data[this.data.nowNode.id],\r\n\t\t\t\tvalue:this.data.nowNode.text\r\n\t\t\t}\t\t\t\t\r\n\t\t}\r\n\t\tsetDefaultVal(val=\"\"){\t\t//设置默认值，为异步设置默认值用得\r\n\t\t\tthis.o.value=val\r\n\t\t\tthis.node.input.val(val)\r\n\t\t\tlet item=\"\";\r\n\t\t\tfor(let i=0,l=this.o.data.length;i<l;i++){\r\n\t\t\t\titem=this.o.key?this.o.data[i][this.o.key]:this.o.data[i];\r\n\t\t\t\tif(item===val){\t\t\t\t\t\r\n\t\t\t\t\tthis.data.nowNode={\r\n\t\t\t\t\t\tid:i,\r\n\t\t\t\t\t\ttext:item\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tgotoActive(){\t\t\t//设置已经选中项在页面可视区域\r\n\t\t\tif(this.data.nowNode.id === -1){\t\t//如果没有选中项，\r\n\t\t\t\tthis.node.drop.scrollTop(0)\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t\tconst $active=this.node.items.eq(this.data.nowNode.id),\r\n\t\t\t\t  currentOffset=this.node.drop.offset().top + this.node.drop.outerHeight(false),\r\n\t\t\t\t  activeBottom = $active.offset().top + $active.outerHeight(false),\r\n\t\t\t\t  activeOffset = this.node.drop.scrollTop() + activeBottom - currentOffset;\r\n\t\t\tthis.node.drop.scrollTop(activeOffset)\r\n\t\t}\r\n\t\tsetPosition(){\t\t//设置下拉框得位置和大小\r\n\t\t\tconst currentOffset=this.node.select.offset(),\r\n\t\t\t      currentTop=currentOffset.top+this.node.select.outerHeight(false),\r\n\t\t\t      currentWidth=this.node.select.outerWidth(),\r\n\t\t\t      currentLeft=currentOffset.left;\r\n\t\t\tthis.node.drop.css({\r\n\t\t\t\tleft:currentLeft,\r\n\t\t\t\ttop:currentTop,\r\n\t\t\t\twidth:currentWidth-2\r\n\t\t\t})\r\n\t\t}\r\n\t\tbind(){\t\t//绑定事件\r\n\t\t\tconst self=this;\r\n\t\t\tconst $input=(()=>{\t\t\t//选择接受点击事件得元素\r\n\t\t\t\tif(!this.o.search){\r\n\t\t\t\t\treturn this.node.select.find(\".inputDisabled\")\r\n\t\t\t\t}else{\r\n\t\t\t\t\treturn this.node.input\r\n\t\t\t\t}\r\n\t\t\t})();\r\n\t\t\t$input.on(\"click\",e=>{\t\t\t\t//显示下拉菜单\r\n\t\t\t\tconst ev=window.event|| e\r\n\t\t\t\tconst flag=this.renderList(this.o.value)\r\n\t\t\t\tif(!flag){\t\t//没有数据\r\n\t\t\t\t\tself.node.lists.html(`<li data-disabled=\"true\">${this.o.noData}</li>`)\r\n\t\t\t\t}\r\n\t\t\t\tthis.setPosition()\r\n\t\t\t\tthis.node.mask.show()\r\n\t\t\t\tthis.node.drop.show();\r\n\t\t\t\tthis.gotoActive()\r\n\t\t\t\tthis.data.show=true;\t\t\t\r\n\t\t\t\tthis.data.tabIndex=this.data.nowNode.id<0?0:this.data.nowNode.id;\t\t//tabindex默认是0\r\n\r\n\t\t\t\t//重新绑定事件\r\n\t\t\t\tthis.bindMask($input)\r\n\t\t\t\tthis.bindItem()\r\n\r\n\t\t\t\t$(window).on(\"resize\",resizeWindow(this))\r\n\t\t\t\t$(window).on(\"scroll\",this.setPosition.bind(this))\r\n\t\t\t\tev.stopPropagation?ev.stopPropagation():ev.cancelBubble=true;\r\n\t\t\t})\r\n\t\t\tthis.bindKeyDown($input)\r\n\t\t}\r\n\t\tbindItem(){\t\t\t//为列表绑定事件\r\n\t\t\tconst self=this;\r\n\t\t\tthis.node.lists.on(\"mouseenter\",\"li\",function(){\t\t//鼠标滑过\r\n\t\t\t\t$(this).addClass(\"active\").siblings().removeClass(\"active\")\r\n\t\t\t\tself.data.tabIndex=$(this).data(\"id\")\r\n\t\t\t})\r\n\t\t\tthis.node.lists.on(\"click\",\"li\",function(e){\t\t\t//点击具体得item\r\n\t\t\t\tvar ev=window.event|| e\r\n\t\t\t\tconst $that=$(this);\t\t\r\n\t\t\t\tif($that.data(\"disabled\")) return false;\t\t//当前不可点击\r\n\t\t\t\tactiveList($that,\"active\",self)\r\n\t\t\t\tself.node.input.val(self.data.nowNode.text)\r\n\t\t\t\tlistHide(self)\r\n\t\t\t\tev.stopPropagation?ev.stopPropagation():ev.cancelBubble=true;\r\n\t\t\t})\r\n\t\t}\r\n\t\tbindMask($input){   //为背景设置点击事件\t\t\t\r\n\t\t\tthis.node.mask.on('click',()=>{\t\t\t//点击其它地方隐藏下拉框\r\n\t\t\t\tif(this.data.show){\r\n\t\t\t\t\tif(this.data.nowNode.text !== \"\"){\t\t//如果没有选择，则再关闭时回复输入框默认的值\r\n\t\t\t\t\t\t$input.val(this.data.nowNode.text)\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t$input.val(this.o.value)\r\n\t\t\t\t\t}\t\t\r\n\t\t\t\t\tlistHide(this)\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tbindKeyDown($input){\t\t//绑定键盘事件\t\r\n\t\t\tconst self=this;\t\r\n\t\t\tthis.node.select.on(\"keydown\",e=>{\t\t\t//上下键\r\n\t\t\t\tconst ev=window.event|| e;\t\t\t\t\r\n\t\t\t\tif(ev.keyCode==38){\t\t\t\t//按↑键\r\n\t\t\t\t\tif(this.data.tabIndex<=0) return false;\r\n\t\t\t\t\t--this.data.tabIndex\r\n\t\t\t\t\tconst currentOffset=this.node.drop.offset().top,\r\n\t\t\t\t\t\t  $next=this.node.items.eq(this.data.tabIndex),\r\n\t\t\t\t\t\t  nextTop = $next.offset().top,\r\n\t\t\t\t\t\t  nextOffset = this.node.drop.scrollTop() + (nextTop - currentOffset);\r\n\t\t\t\t\t$next.addClass(\"active\").siblings().removeClass(\"active\")\r\n\t\t\t\t\tif(nextTop - currentOffset < 0){\r\n\t\t\t\t\t\tthis.node.drop.scrollTop(nextOffset)\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\tif(ev.keyCode==40){\t\t//按↓键\r\n\t\t\t\t\tif(this.data.tabIndex>=this.data.searchLength-1) return false;\r\n\t\t\t\t\t++this.data.tabIndex;\r\n\t\t\t\t\tconst $next=this.node.items.eq(this.data.tabIndex),\r\n\t\t\t\t\t\t  currentOffset = this.node.drop.offset().top + this.node.drop.outerHeight(false),\r\n\t\t\t\t\t\t  nextBottom = $next.offset().top + $next.outerHeight(false),\r\n\t\t\t\t\t\t  nextOffset = this.node.drop.scrollTop() + nextBottom - currentOffset;\r\n\t\t\t\t\t$next.addClass(\"active\").siblings().removeClass(\"active\")\r\n\t\t\t\t\tif(nextBottom > currentOffset){\r\n\t\t\t\t\t\tthis.node.drop.scrollTop(nextOffset)\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\t\t\t\r\n\t\t\t\tif(ev.keyCode==13){\t\t//回车\r\n\t\t\t\t\tlet nowNode=self.node.items.eq(self.data.tabIndex);\r\n\t\t\t\t\tif(nowNode.data(\"disabled\")) return false;\t\t//当前不可点击\r\n\t\t\t\t\tlistHide(self)\t\r\n\t\t\t\t\tactiveList(nowNode,\"active\",self)\r\n\t\t\t\t\tself.node.input.val(self.data.nowNode.text)\r\n\t\t\t\t\tconst back=self.getValue();\r\n\t\t\t\t\tself.o.callback && self.o.callback(back.data,back.value)\r\n\t\t\t\t\t$input.blur()\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\tsearch(){\t\t\t//搜索\r\n\t\t\tconst self=this;\r\n\t\t\tthis.node.input.on(\"input propertychange\",function(){\r\n\t\t\t\tif(self.data.listLength<=0){ //没有数据还搜索\r\n\t\t\t\t\tself.node.lists.html(`<li data-disabled=\"true\">${this.o.noData}</li>`)\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\tconst val=$.trim(this.value);\r\n\t\t\t\tconst flag=self.renderList(val,true)\r\n\t\t\t\tif(!flag){\t\t//没有搜索到匹配的\r\n\t\t\t\t\tself.node.lists.html(`<li data-disabled=\"true\">未找到“${val}”</li>`)\t\t\t\t\t\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}else{\r\n\t\t\t\t\tif(val===\"\"){\t\t//如果输入框是空\r\n\t\t\t\t\t\tself.data.tabIndex=self.data.nowNode.id\r\n\t\t\t\t\t\tself.gotoActive()\r\n\t\t\t\t\t}else{\t\t\t\t//匹配到输入的内容，并让第一个item获得焦点\r\n\t\t\t\t\t\tself.data.tabIndex=0\r\n\t\t\t\t\t\tself.node.items.eq(0).addClass(\"active\").siblings().removeClass(\"active\")\r\n\t\t\t\t\t}\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\tw.selectPick=selectPick;\r\n})(jQuery, window, document)\r\n"]}