"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}();!function(t,e,i,a){var o=function(t){t.setPosition()},d=function(t,e,i){t.addClass(e).siblings().removeClass(e),i.data.nowNode={id:t.data("id"),text:t.text()}},n=function(e){e.data.show=!1,e.node.drop.hide(),e.node.mask.hide(),e.node.lists.off("click mouseenter"),e.node.mask.off("click"),t(window).off("resize",o(e)),t(window).off("scroll",e.setPosition())},s={container:"body",search:!1,data:[],key:null,value:"",listLength:4,listHeight:32,placeholder:"请输入",callback:null,noData:"没有数据"},l=function(){function e(i){_classCallCheck(this,e),this.o=t.extend(!0,{},s,i||{}),this.dom=t(this.o.container),this.data={listLength:0,searchLength:0,show:!1,change:!1,tabIndex:0,nowNode:{id:-1,text:""}},this.node={}}return _createClass(e,[{key:"init",value:function(){this.renderHTML(),this.bind(),this.o.search&&this.search()}},{key:"renderHTML",value:function(){this.node.select=t(' <div class="selectPick" ><input type="text" placeholder="'+this.o.placeholder+'" value="'+this.o.value+'"></div>');var e=i.getElementById("selectMask");e?this.node.mask=t(e):(this.node.mask=t("<div id='selectMask'></div>"),t("body").append(this.node.mask));var a=i.getElementById("selectDrop");a?this.node.drop=t(a):(this.node.drop=t('<div id="selectDrop" style="max-height:'+this.o.listLength*this.o.listHeight+'px"><ul></ul></div>'),t("body").append(this.node.drop)),this.dom.html(this.node.select),this.node.input=this.node.select.find("input"),this.node.lists=this.node.drop.find("ul"),this.o.search||(this.node.input.attr("disabled","disabled"),this.node.select.append('<div class="inputDisabled"></div>'))}},{key:"renderList",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i="",a="",o=this.data.nowNode.id>=0?this.data.nowNode.id:0;if(this.data.searchLength=0,this.data.listLength=this.o.data.length,this.data.listLength<=0||""===this.o.data[0])return!1;for(var d=0;d<this.data.listLength;d++)a=this.o.key?this.o.data[d][this.o.key]:this.o.data[d],this.o.search&&a.indexOf(t)<0&&""!=t&&e||(""!=t&&this.data.nowNode.id<0?a===t?(i+='<li data-id="'+d+'" class="active">'+a+"</li>",this.data.nowNode={id:d,text:a},this.data.tabIndex=d):i+='<li data-id="'+d+'">'+a+"</li>":i+='<li data-id="'+d+'" '+(o===d?'class="active"':"")+">"+a+"</li>",++this.data.searchLength);return(!this.o.search||""!==i)&&(this.node.lists.html(i),this.node.items=this.node.lists.find("li"),!0)}},{key:"setData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.o.data=t,""===this.o.value?this.node.input.val(""):this.node.input.val(this.o.value),this.data={show:!1,nowNode:{id:-1,text:""}},this.data.show=!1,this.node.drop.hide(),this.node.mask.hide(),this}},{key:"getValue",value:function(){return{data:this.data.nowNode.id<0?-1:this.o.data[this.data.nowNode.id],value:this.data.nowNode.text}}},{key:"setDefaultVal",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.o.value=t,this.node.input.val(t);for(var e="",i=0,a=this.o.data.length;i<a;i++)if((e=this.o.key?this.o.data[i][this.o.key]:this.o.data[i])===t)return this.data.nowNode={id:i,text:e},!1}},{key:"gotoActive",value:function(){if(-1===this.data.nowNode.id)return this.node.drop.scrollTop(0),!1;var t=this.node.items.eq(this.data.nowNode.id),e=this.node.drop.offset().top+this.node.drop.outerHeight(!1),i=t.offset().top+t.outerHeight(!1),a=this.node.drop.scrollTop()+i-e;this.node.drop.scrollTop(a)}},{key:"setPosition",value:function(){var t=this.node.select.offset(),e=t.top+this.node.select.outerHeight(!1),i=this.node.select.outerWidth(),a=t.left;this.node.drop.css({left:a,top:e,width:i-2})}},{key:"bind",value:function(){var e=this,i=this,a=e.o.search?e.node.input:e.node.select.find(".inputDisabled");a.on("click",function(d){var n=window.event||d;e.renderList(e.o.value)||i.node.lists.html('<li data-disabled="true">'+e.o.noData+"</li>"),e.setPosition(),e.node.mask.show(),e.node.drop.show(),e.gotoActive(),e.data.show=!0,e.data.tabIndex=e.data.nowNode.id<0?0:e.data.nowNode.id,e.bindMask(a),e.bindItem(),t(window).on("resize",o(e)),t(window).on("scroll",e.setPosition.bind(e)),n.stopPropagation?n.stopPropagation():n.cancelBubble=!0}),this.bindKeyDown(a)}},{key:"bindItem",value:function(){var e=this;this.node.lists.on("mouseenter","li",function(){t(this).addClass("active").siblings().removeClass("active"),e.data.tabIndex=t(this).data("id")}),this.node.lists.on("click","li",function(i){var a=window.event||i,o=t(this);if(o.data("disabled"))return!1;d(o,"active",e),e.node.input.val(e.data.nowNode.text),n(e),a.stopPropagation?a.stopPropagation():a.cancelBubble=!0})}},{key:"bindMask",value:function(t){var e=this;this.node.mask.on("click",function(){e.data.show&&(""!==e.data.nowNode.text?t.val(e.data.nowNode.text):t.val(e.o.value),n(e))})}},{key:"bindKeyDown",value:function(t){var e=this,i=this;this.node.select.on("keydown",function(a){var o=window.event||a;if(38==o.keyCode){if(e.data.tabIndex<=0)return!1;--e.data.tabIndex;var s=e.node.drop.offset().top,l=e.node.items.eq(e.data.tabIndex),h=l.offset().top,r=e.node.drop.scrollTop()+(h-s);return l.addClass("active").siblings().removeClass("active"),h-s<0&&e.node.drop.scrollTop(r),!1}if(40==o.keyCode){if(e.data.tabIndex>=e.data.searchLength-1)return!1;++e.data.tabIndex;var c=e.node.items.eq(e.data.tabIndex),u=e.node.drop.offset().top+e.node.drop.outerHeight(!1),v=c.offset().top+c.outerHeight(!1),f=e.node.drop.scrollTop()+v-u;return c.addClass("active").siblings().removeClass("active"),v>u&&e.node.drop.scrollTop(f),!1}if(13==o.keyCode){var p=i.node.items.eq(i.data.tabIndex);if(p.data("disabled"))return!1;n(i),d(p,"active",i),i.node.input.val(i.data.nowNode.text);var b=i.getValue();i.o.callback&&i.o.callback(b.data,b.value),t.blur()}})}},{key:"search",value:function(){var e=this;this.node.input.on("input propertychange",function(){if(e.data.listLength<=0)return e.node.lists.html('<li data-disabled="true">'+this.o.noData+"</li>"),!1;var i=t.trim(this.value);if(!e.renderList(i,!0))return e.node.lists.html('<li data-disabled="true">未找到“'+i+"”</li>"),!1;""===i?(e.data.tabIndex=e.data.nowNode.id,e.gotoActive()):(e.data.tabIndex=0,e.node.items.eq(0).addClass("active").siblings().removeClass("active"))})}}]),e}();e.selectPick=l}(jQuery,window,document);
//# sourceMappingURL=../maps/selectPick---copy.min.js.map
