"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}();!function(t,e,i,a){var s=function(t){t.setPosition()},o=function(t,e,i){t.addClass(e).siblings().removeClass(e),i.data.nowNode={id:t.data("id"),text:t.text()}},d=function(e){e.data.show=!1,l.drop.hide(),l.mask.hide(),l.lists.off("click mouseenter"),l.mask.off("click"),t(window).off("resize",s(e)),t(window).off("scroll",e.setPosition())},n={container:"body",search:!1,data:[],key:null,value:"",listLength:4,listHeight:32,placeholder:"请输入",callback:null,noData:"没有数据"},l={},r=function(){function e(i){_classCallCheck(this,e),this.o=t.extend(!0,{},n,i||{}),this.data={listLength:0,searchLength:0,show:!1,change:!1,tabIndex:0,nowNode:{id:-1,text:""}},this.child={}}return _createClass(e,[{key:"init",value:function(){this.renderHTML(),this.bind(),this.o.search&&this.search()}},{key:"renderHTML",value:function(){this.child.select=t(' <div class="selectPick" ><input type="text" placeholder="'+this.o.placeholder+'" value="'+this.o.value+'"></div>');var e=i.getElementById("selectMask");e?l.mask=t(e):(l.mask=t("<div id='selectMask'></div>"),t("body").append(l.mask));var a=i.getElementById("selectDrop");a?l.drop=t(a):(l.drop=t('<div id="selectDrop" style="max-height:'+this.o.listLength*this.o.listHeight+'px"><ul></ul></div>'),t("body").append(l.drop)),t(this.o.container).html(this.child.select),this.child.input=this.child.select.find("input"),l.lists=l.drop.find("ul"),this.o.search||(this.child.input.attr("disabled","disabled"),this.child.select.append('<div class="inputDisabled"></div>'))}},{key:"renderList",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i="",a="",s=this.data.nowNode.id>=0?this.data.nowNode.id:0;if(this.data.searchLength=0,this.data.listLength=this.o.data.length,this.data.listLength<=0||""===this.o.data[0])return!1;for(var o=0;o<this.data.listLength;o++)a=this.o.key?this.o.data[o][this.o.key]:this.o.data[o],this.o.search&&a.indexOf(t)<0&&""!=t&&e||(""!=t&&this.data.nowNode.id<0?a===t?(i+='<li data-id="'+o+'" class="active">'+a+"</li>",this.data.nowNode={id:o,text:a},this.data.tabIndex=o):i+='<li data-id="'+o+'">'+a+"</li>":i+='<li data-id="'+o+'" '+(s===o?'class="active"':"")+">"+a+"</li>",++this.data.searchLength);return(!this.o.search||""!==i)&&(l.lists.html(i),l.items=l.lists.find("li"),!0)}},{key:"setData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.o.data=t,""===this.o.value?this.child.input.val(""):this.child.input.val(this.o.value),this.data={show:!1,nowNode:{id:-1,text:""}},this.data.show=!1,l.drop.hide(),l.mask.hide(),this}},{key:"getValue",value:function(){return{data:this.data.nowNode.id<0?-1:this.o.data[this.data.nowNode.id],value:this.data.nowNode.text}}},{key:"setDefaultVal",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.o.value=t,this.child.input.val(t);for(var e="",i=0,a=this.o.data.length;i<a;i++)if((e=this.o.key?this.o.data[i][this.o.key]:this.o.data[i])===t)return this.data.nowNode={id:i,text:e},!1}},{key:"gotoActive",value:function(){if(-1===this.data.nowNode.id)return l.drop.scrollTop(0),!1;var t=l.items.eq(this.data.nowNode.id),e=l.drop.offset().top+l.drop.outerHeight(!1),i=t.offset().top+t.outerHeight(!1),a=l.drop.scrollTop()+i-e;l.drop.scrollTop(a)}},{key:"setPosition",value:function(){var t=this.child.select.offset(),e=t.top+this.child.select.outerHeight(!1),i=this.child.select.outerWidth(),a=t.left;l.drop.css({left:a,top:e,width:i-2})}},{key:"bind",value:function(){var e=this,i=e.o.search?e.child.input:e.child.select.find(".inputDisabled");i.on("click",function(a){var o=window.event||a;e.renderList(e.o.value)||l.lists.html('<li data-disabled="true">'+e.o.noData+"</li>"),e.setPosition(),l.mask.show(),l.drop.show(),e.gotoActive(),e.data.show=!0,e.data.tabIndex=e.data.nowNode.id<0?0:e.data.nowNode.id,e.bindMask(i),e.bindItem(),t(window).on("resize",s(e)),t(window).on("scroll",e.setPosition.bind(e)),o.stopPropagation?o.stopPropagation():o.cancelBubble=!0}),this.bindKeyDown(i)}},{key:"bindItem",value:function(){var e=this;l.lists.on("mouseenter","li",function(){t(this).addClass("active").siblings().removeClass("active"),e.data.tabIndex=t(this).data("id")}),l.lists.on("click","li",function(i){var a=window.event||i,s=t(this);if(s.data("disabled"))return!1;o(s,"active",e),e.child.input.val(e.data.nowNode.text),d(e),a.stopPropagation?a.stopPropagation():a.cancelBubble=!0})}},{key:"bindMask",value:function(t){var e=this;l.mask.on("click",function(){e.data.show&&(""!==e.data.nowNode.text?t.val(e.data.nowNode.text):t.val(e.o.value),d(e))})}},{key:"bindKeyDown",value:function(t){var e=this,i=this;this.child.select.on("keydown",function(a){var s=window.event||a;if(38==s.keyCode){if(e.data.tabIndex<=0)return!1;--e.data.tabIndex;var n=l.drop.offset().top,r=l.items.eq(e.data.tabIndex),h=r.offset().top,c=l.drop.scrollTop()+(h-n);return r.addClass("active").siblings().removeClass("active"),h-n<0&&l.drop.scrollTop(c),!1}if(40==s.keyCode){if(e.data.tabIndex>=e.data.searchLength-1)return!1;++e.data.tabIndex;var u=l.items.eq(e.data.tabIndex),v=l.drop.offset().top+l.drop.outerHeight(!1),f=u.offset().top+u.outerHeight(!1),p=l.drop.scrollTop()+f-v;return u.addClass("active").siblings().removeClass("active"),f>v&&l.drop.scrollTop(p),!1}if(13==s.keyCode){var b=l.items.eq(i.data.tabIndex);if(b.data("disabled"))return!1;d(i),o(b,"active",i),e.child.input.val(i.data.nowNode.text);var w=i.getValue();i.o.callback&&i.o.callback(w.data,w.value),t.blur()}})}},{key:"search",value:function(){var e=this;this.child.input.on("input propertychange",function(){if(e.data.listLength<=0)return l.lists.html('<li data-disabled="true">'+this.o.noData+"</li>"),!1;var i=t.trim(this.value);if(!e.renderList(i,!0))return l.lists.html('<li data-disabled="true">未找到“'+i+"”</li>"),!1;""===i?(e.data.tabIndex=e.data.nowNode.id,e.gotoActive()):(e.data.tabIndex=0,l.items.eq(0).addClass("active").siblings().removeClass("active"))})}}]),e}();e.selectPick=r}(jQuery,window,document);
//# sourceMappingURL=../maps/selectPick.min.js.map
