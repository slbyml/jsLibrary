"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,a,i){return a&&t(e.prototype,a),i&&t(e,i),e}}();!function(t,e,a,i){var o=function(t){t.setPosition()},s=function(t,e,a){t.addClass(e).siblings().removeClass(e),a.data.nowNode={id:t.data("id"),text:t.text()}},d=function(e){e.data.show=!1,l.drop.hide(),l.mask.hide(),l.lists.off("click mouseenter"),l.mask.off("click"),t(window).off("resize",o(e)),t(window).off("scroll",e.setPosition())},n={container:"body",search:!1,data:[],key:null,value:"",listLength:4,listHeight:32,placeholder:"请输入",callback:null,noData:"没有数据"},l={},r=function(){function e(a){_classCallCheck(this,e),this.o=t.extend(!0,{},n,a||{}),this.data={listLength:0,searchLength:0,show:!1,change:!1,tabIndex:0,nowNode:{id:-1,text:""}},this.child={}}return _createClass(e,[{key:"init",value:function(){this.renderHTML(),this.bind(),this.o.search&&this.search()}},{key:"renderHTML",value:function(){this.child.select=t(' <div class="selectPick" ><input type="text" placeholder="'+this.o.placeholder+'" value="'+this.o.value+'"></div>');var e=a.getElementById("selectMask");e?l.mask=t(e):(l.mask=t("<div id='selectMask'></div>"),t("body").append(l.mask));var i=a.getElementById("selectDrop");i?l.drop=t(i):(l.drop=t('<div id="selectDrop" style="max-height:'+this.o.listLength*this.o.listHeight+'px"><ul></ul></div>'),t("body").append(l.drop)),t(this.o.container).html(this.child.select),this.child.input=this.child.select.find("input"),l.lists=l.drop.find("ul"),this.o.search||(this.child.input.attr("disabled","disabled"),this.child.select.append('<div class="inputDisabled"></div>'))}},{key:"renderList",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a="",i="",o=this.data.nowNode.id>=0?this.data.nowNode.id:0;if(this.data.searchLength=0,this.data.listLength=this.o.data.length,this.data.listLength<=0||""===this.o.data[0])return!1;for(var s=0;s<this.data.listLength;s++)i=this.o.key?this.o.data[s][this.o.key]:this.o.data[s],this.o.search&&e&&""!=t&&i.indexOf(t)<0||(""!=t?i===t?(a+='<li data-id="'+s+'" class="active">'+i+"</li>",this.data.nowNode={id:s,text:i},this.data.tabIndex=s):a+='<li data-id="'+s+'">'+i+"</li>":a+='<li data-id="'+s+'" '+(o===s?'class="active"':"")+">"+i+"</li>",++this.data.searchLength);return(!this.o.search||""!==a)&&(l.lists.html(a),l.items=l.lists.find("li"),!0)}},{key:"setData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.o.data=t,""===this.o.value?this.child.input.val(""):this.child.input.val(this.o.value),this.data={show:!1,nowNode:{id:-1,text:""}},this.data.show=!1,l.drop.hide(),l.mask.hide(),this}},{key:"getValue",value:function(){return{data:this.data.nowNode.id<0?-1:this.o.data[this.data.nowNode.id],value:this.data.nowNode.text}}},{key:"setDefaultVal",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.o.value=t,this.child.input.val(t),""===t)return this.data.nowNode={id:-1,text:""},!1;for(var e="",a=0,i=this.o.data.length;a<i;a++)if((e=this.o.key?this.o.data[a][this.o.key]:this.o.data[a])===t)return this.data.nowNode={id:a,text:e},!1}},{key:"gotoActive",value:function(){if(-1===this.data.nowNode.id)return l.drop.scrollTop(0),!1;var t=l.items.eq(this.data.nowNode.id),e=l.drop.offset().top+l.drop.outerHeight(!1),a=t.offset().top+t.outerHeight(!1),i=l.drop.scrollTop()+a-e;l.drop.scrollTop(i)}},{key:"setPosition",value:function(){var t=this.child.select.offset(),e=t.top+this.child.select.outerHeight(!1),a=this.child.select.outerWidth(),i=t.left;l.drop.css({left:i,top:e,width:a-2})}},{key:"bind",value:function(){var e=this,a=e.o.search?e.child.input:e.child.select.find(".inputDisabled");a.on("click",function(i){var s=window.event||i;e.renderList(e.o.value)||l.lists.html('<li data-disabled="true">'+e.o.noData+"</li>"),e.setPosition(),l.mask.show(),l.drop.show(),e.gotoActive(),e.data.show=!0,e.data.tabIndex=e.data.nowNode.id<0?0:e.data.nowNode.id,e.bindMask(a),e.bindItem(),t(window).on("resize",o(e)),t(window).on("scroll",e.setPosition.bind(e)),s.stopPropagation?s.stopPropagation():s.cancelBubble=!0}),this.bindKeyDown(a)}},{key:"bindItem",value:function(){var e=this;l.lists.on("mouseenter","li",function(){t(this).addClass("active").siblings().removeClass("active"),e.data.tabIndex=t(this).data("id")}),l.lists.on("click","li",function(a){var i=window.event||a,o=t(this);if(o.data("disabled"))return!1;if(s(o,"active",e),e.child.input.val(e.data.nowNode.text),d(e),e.o.callback){var n=e.getValue();e.o.callback(n.data,n.value)}i.stopPropagation?i.stopPropagation():i.cancelBubble=!0})}},{key:"bindMask",value:function(t){var e=this;l.mask.on("click",function(){if(e.data.show){if(""!==e.data.nowNode.text){if(""!==t.val()&&e.o.callback&&e.o.search){var a=e.getValue();e.o.callback(a.data,a.value)}t.val(e.data.nowNode.text)}else t.val(e.o.value);d(e)}})}},{key:"bindKeyDown",value:function(t){var e=this,a=this;this.child.select.on("keydown",function(i){var o=window.event||i;if(38==o.keyCode){if(e.data.tabIndex<=0)return!1;--e.data.tabIndex;var n=l.drop.offset().top,r=l.items.eq(e.data.tabIndex),h=r.offset().top,c=l.drop.scrollTop()+(h-n);return r.addClass("active").siblings().removeClass("active"),h-n<0&&l.drop.scrollTop(c),!1}if(40==o.keyCode){if(e.data.tabIndex>=e.data.searchLength-1)return!1;++e.data.tabIndex;var u=l.items.eq(e.data.tabIndex),v=l.drop.offset().top+l.drop.outerHeight(!1),f=u.offset().top+u.outerHeight(!1),p=l.drop.scrollTop()+f-v;return u.addClass("active").siblings().removeClass("active"),f>v&&l.drop.scrollTop(p),!1}if(13==o.keyCode){var b=l.items.eq(a.data.tabIndex);if(b.data("disabled"))return!1;if(d(a),s(b,"active",a),e.child.input.val(a.data.nowNode.text),a.o.callback){var k=a.getValue();a.o.callback(k.data,k.value)}t.blur()}})}},{key:"search",value:function(){var e=this;this.child.input.on("input propertychange",function(){var a=t.trim(this.value);return e.data.listLength<=0?(l.lists.html('<li data-disabled="true">'+(""===a?""+e.o.noData:"未找到“"+a+"”")+"</li>"),!1):e.renderList(a,!0)?void(""===a?(e.data.tabIndex=e.data.nowNode.id,e.gotoActive()):(e.data.tabIndex=0,l.items.eq(0).addClass("active").siblings().removeClass("active"))):(l.lists.html('<li data-disabled="true">未找到“'+a+"”</li>"),!1)})}}]),e}();e.selectPick=r}(jQuery,window,document);
//# sourceMappingURL=../maps/selectPick.min.js.map
