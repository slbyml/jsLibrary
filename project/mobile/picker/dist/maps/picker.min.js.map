{"version":3,"sources":["picker.js"],"names":["window","document","undefined","selectDate","monthDay","translatedTwo","num","alloyArr","AlloyTouchFn","scroll","h","txt","min","Transform","isLeap","touch","y","max","property","step","initialValue","picker","_classCallCheck","this","ele","target","Object","assign","defaults","opt","$dom","is","isInput","_createClass","key","value","endYear","getElementById","$","append","callback","setTimeout","classList","add","AlloyTouch","pickerEvent","creatYear","creatMonth","creatDate","n","html","year","querySelector","options","itemH","onclick","_this","destroy","month","date","forEach","item","remove","that","i","li","initIndex","starYear","m","scrollArr","yearScroll","oUl","innerHTML","translateY","addClass","index","nowdate","Date","yearscrollEnd","animationEnd","eq","siblings","removeClass","parseInt","renderItem","sdate","monthscrollEnd","num2","data","val","datescrollEnd","_Bj","createElement","id","style","display","ttime","getFullYear","nowDate","getMonth","getDate","fn","dataPicker","init"],"mappings":"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","file":"../js/picker.min.js","sourcesContent":["/*日历插件\r\n     *starYear：开始年份\r\n     *endYear：结束年份\r\n     *callback：点起确定的回掉\r\n     */\r\n;(function(window, document, undefined) {\r\n    let selectDate = {}; //当前选择的日期\r\n    let monthDay = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]; //每个月有多少天\r\n    let yearScroll=null,yearMonth=null,dateScroll=null\r\n    const translatedTwo= num=> { //将一位数转为两位数\r\n        if (num < 10) {\r\n            num = '0' + num\r\n        }\r\n        return '' + num\r\n    };\r\n    let ttime = null;\r\n\r\n    const nowDate=txt=> { //获取时间\r\n        let nowdate;\r\n        if (txt) {\r\n            nowdate = new Date(txt)\r\n        } else {\r\n            nowdate = new Date()\r\n        };\r\n        selectDate = {\r\n            year: translatedTwo(nowdate.getFullYear()),\r\n            month: translatedTwo(nowdate.getMonth() + 1),\r\n            date: translatedTwo(nowdate.getDate())\r\n        };\r\n    };\r\n\r\n    const isLeap=y=> { //是否是润年\r\n        if ((y % 4 == 0 && y % 100 != 0) || y % 400 == 0) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    };\r\n    let alloyArr = {};\r\n    const AlloyTouchFn=(scroll, h, txt, min)=> { //初始化滚动\r\n        Transform(scroll, true);\r\n        alloyArr[txt] = new AlloyTouch({\r\n            touch: scroll,\r\n            target: scroll,\r\n            max: 0,\r\n            min: min * h || 0,\r\n            property: \"translateY\",\r\n            step: h,\r\n            initialValue: 0\r\n        })\r\n    };\r\n    class picker {\r\n    \tconstructor(ele, opt){\r\n\t        this.$dom = ele\r\n            this.defaults = {\r\n                starYear: 2010,\r\n                itemH: 42, \t\t\t//每个li的高度\r\n                endYear: 2030,\r\n                callback: null\r\n            }\r\n            this.options = Object.assign(true, this.defaults, opt || {});\r\n\t        if (this.$dom.is('input')) { //判断当前标签是否是input\r\n\t            this.isInput = true;\r\n\t        } else {\r\n\t            this.isInput = false;\r\n\t        }    \t\t\r\n    \t}\r\n    \tinit(){\r\n            this.event();\r\n            return this    \t\t\r\n    \t}    \t\r\n        renderDom() {\r\n            if (document.getElementById('zlwDateBox')) return false;\r\n            let html = `<div id=\"zlwDateBox\">\r\n            \t\t\t\t<header class=\"pickerHeader\"><button class=\"pickerBtn\" id=\"pickerSure\">确定</button><button class=\"pickerBtn\" id=\"pickerEsc\">取消</button>\r\n                        </header>\r\n                        <section class=\"pickerTitle\"><span>年</span><span>月</span><span>日</span></section>\r\n                        <div class=\"pickerBody\">\r\n                            <div class=\"pickerList\" id=\"yearBox\"><div><ul></ul></div></div>\r\n                            <div class=\"pickerList\" id=\"monthBox\"><ul></ul></div>\r\n                            <div class=\"pickerList\" id=\"dateBox\"><ul></ul></div>\r\n                        </div>\r\n                    </div>`;\r\n            $('body').append(html);\r\n            setTimeout(()=> {\r\n                document.getElementById('zlwDateBox').classList.add('pickerIn')\r\n            }, 10)\r\n            this.AlloyTouch()\r\n            this.pickerEvent()\r\n            this.creatYear();\r\n            this.creatMonth();\r\n            this.creatDate();\r\n        }\r\n        AlloyTouch() {\r\n            let n = this.defaults.endYear - this.defaults.starYear;\r\n            const year = document.querySelector('#yearBox ul');\r\n            const month = document.querySelector('#monthBox ul');\r\n            const date = document.querySelector('#dateBox ul');\r\n            AlloyTouchFn(year, this.options.itemH, 'year', -n + 1);\r\n            AlloyTouchFn(month, this.options.itemH, 'month', -11);\r\n            AlloyTouchFn(date, this.options.itemH, 'date')\r\n        }\r\n        pickerEvent() { //日历事件\r\n            document.getElementById('pickerEsc').onclick = ()=> {\r\n                this.destroy()\r\n            }\r\n            document.getElementById('pickerSure').onclick = ()=> {\r\n                this.destroy();\r\n                const txt = `${selectDate.year}-${selectDate.month}-${selectDate.date}`;\r\n                if (this.isInput) { //如果是input标签则设置input值，否则设置data\r\n                    this.$dom.val(txt)\r\n                } else {\r\n                    this.$dom.data('date', txt)\r\n                };\r\n                this.options.callback && this.options.callback(txt, selectDate)\r\n            }\r\n        }\r\n        destroy() { //销毁\r\n            const scrollArr = [yearScroll, yearMonth, dateScroll];\r\n            scrollArr.forEach(function(item) {\r\n                if (item != null) {\r\n                    item.destroy();\r\n                    item = null;\r\n                }\r\n            });\r\n            document.getElementById('pickerEsc').onclick = null;\r\n            document.getElementById('pickerSure').onclick = null;\r\n            document.getElementById('zlwDateBox').classList.remove('pickerIn');\r\n            setTimeout(()=> {\r\n                $('#zlwDateBox,#zlwBj').remove();\r\n            }, 350)\r\n        }\r\n        creatYear() { //创建年份\r\n            const that = this;\r\n            let n = that.defaults.endYear - that.defaults.starYear,\r\n                i = 0,\r\n                li = '',\r\n                h = that.options.itemH;\r\n            let initIndex = selectDate.year - that.options.starYear;\r\n            for (; i < n; i++) {\r\n                let m = (that.defaults.starYear + i);\r\n                if (initIndex === i) {\r\n                    li += `<li data-num='${m}' class='on'>${m}</li>`\r\n                } else {\r\n                    li += `<li data-num='${m}'>${m}</li>`\r\n                }\r\n            };\r\n\r\n            const yearscrollEnd=val=>{ //滚动结束的回掉\r\n                let index = -val / h;\r\n                $('#yearBox li').eq(index).addClass('on').siblings().removeClass('on')\r\n                selectDate.year = that.options.starYear + index;\r\n                if (isLeap(selectDate.year)) { //闰年改变二月的天数\r\n                    monthDay[1] = 29;\r\n                } else {\r\n                    monthDay[1] = 28\r\n                }\r\n                if (selectDate.month === '02') {\r\n                    that.creatDate(index)\r\n                }\r\n            };\r\n            const oUl = document.getElementById('yearBox');\r\n            oUl.querySelector('ul').innerHTML = li;\r\n            const scroll = oUl.querySelector('ul');\r\n            scroll.translateY = -initIndex * h;\r\n            alloyArr.year.animationEnd = function(value) {\r\n                yearscrollEnd(value)\r\n            }\r\n        }\r\n        creatMonth() { //创建月份\r\n            let that = this,\r\n                i = 1,\r\n                li = '',\r\n                index = 0;\r\n            const oUl = document.getElementById('monthBox');\r\n            let scroll = oUl.querySelector('ul');\r\n            let initIndex = selectDate.month - 1;\r\n            let h = that.options.itemH;\r\n            this.renderItem(12, oUl, 1, initIndex + 1);\r\n\r\n            const monthscrollEnd=val=>{\r\n                index = -val / h;\r\n                selectDate.month = translatedTwo(1 + index);\r\n                that.creatDate(index)\r\n                $('#monthBox li').eq(index).addClass('on').siblings().removeClass('on')\r\n            };\r\n            scroll.translateY = -initIndex * h;\r\n            alloyArr.month.animationEnd = function(value) {\r\n                monthscrollEnd(value)\r\n            }\r\n        }\r\n        creatDate(num) {\r\n            let that = this,\r\n                i = 1,\r\n                li = '',\r\n                index = 0;\r\n            const oUl = document.getElementById('dateBox');\r\n            const scroll = oUl.querySelector('ul');\r\n            let initIndex = selectDate.date - 1;\r\n            let h = that.options.itemH;\r\n            num = num ? num : parseInt(selectDate.month) - 1;\r\n            this.renderItem(monthDay[selectDate.month - 1], oUl, 1, initIndex + 1);\r\n\r\n            const datescrollEnd=val=>{\r\n                index = -val / h;\r\n                selectDate.date = translatedTwo(1 + index);\r\n                $('#dateBox li').eq(index).addClass('on').siblings().removeClass('on')\r\n            }\r\n            let sdate = parseInt(selectDate.date);\r\n            if (num && sdate > 28 && sdate > monthDay[num]) {\r\n                selectDate.date = '' + monthDay[num];\r\n                $('#dateBox li').eq(selectDate.date - 1).addClass('on').siblings().removeClass('on')\r\n            };\r\n            scroll.translateY = -(selectDate.date - 1) * h;\r\n            alloyArr.date.min = -(monthDay[num] - 1) * h;\r\n            alloyArr.date.animationEnd = function(value) {\r\n                datescrollEnd(value)\r\n            }\r\n        }\r\n        scrollEnd(ele, txt) { //时、分、秒滚动完后回掉\r\n            const that = this;\r\n            index = -ele.y / that.options.itemH;\r\n            selectDate[txt] = translatedTwo(index);\r\n            $(`#${txt}Box li`).eq(index).addClass('on').siblings().removeClass('on')\r\n        }\r\n        renderItem(num, box, num2, initIndex) { //时分秒的填充   \r\n            let that = this,\r\n                i = num2,\r\n                li = '',\r\n                index = 0;\r\n            for (; i <= num; i++) {\r\n                let n = translatedTwo(i);\r\n                if (initIndex === i) {\r\n                    li += `<li data-num='${n}' class='on'>${n}</li>`\r\n                } else {\r\n                    li += `<li data-num='${n}'>${n}</li>`\r\n                }\r\n            };\r\n            box.querySelector('ul').innerHTML = li;\r\n        }\r\n        event() { //事件\r\n            let that = this,\r\n                data;\r\n            this.$dom.on('click', function() {\r\n                if (that.isInput) { //如果是input标签则获取input值，否则获取data\r\n                    data = $(this).val()\r\n                } else {\r\n                    data = $(this).data('date')\r\n                };\r\n                let _Bj = document.getElementById('zlwBj')\r\n                if (!_Bj) {\r\n                    _Bj = document.createElement('DIV');\r\n                    _Bj.id = 'zlwBj';\r\n                    $('body').append(_Bj)\r\n                };\r\n                _Bj.style.display = 'block';\r\n                nowDate(data);\r\n                that.renderDom();\r\n            })\r\n        }\r\n    }\r\n    $.fn.dataPicker = function(options) {\r\n        var d = new picker(this, options);\r\n        return d.init();\r\n    }\r\n})(window, document);\r\n"]}